> 教材第十四章第一节、第二节，第十章

## 密钥分层

![](_images/summary-application-of-symemtric-cipher-1.png ':size=30%')

- 主密钥（Master Key）
  - 用于加密会话密钥
  - 由用户和密钥分发中心共享

- 会话密钥（Session Key）
  - 临时密钥
  - 用于用户之间的数据加密
  - 用于一次性的逻辑连接，然后丢弃

## 对称密钥的安全分发

密钥分发能通过以下方式：
1. A 选择一个密钥后以物理的方式传递给 B
2. 第三方选择密钥后物理地传递给 A 和 B
3. 分布式密钥控制：如果 A 和 B 先前或者最近使用过一个密钥，则一方可以将新密钥用旧密钥加密后发送给另一方
4. 中心化密钥控制：如果 A 和 B 到第三方 C 有加密连接，C 可以在加密连接上传送密钥给 A 和 B
5. 使用**公钥加密**来保护两者共享的密钥
6. 密钥预分发方案

3、4 使用了主密钥，3、4、5、6 需要关注

> [!WARNING]
> 课件中若涉及一些协议，我们需要关注它安不安全，若不安全如何改进


### 分布式密钥控制

![](_images/summary-application-of-symemtric-cipher-2.png)

- 为什么需要 $N_1$，$N_2$？
  - 防止重放攻击。$N_1$，$N_2$ 可以是随机数，也可以是时间戳

- 这种分布式的密钥分配虽然不需要 KDC（Key Distribution Center）的参与，解决了用户分布比较广的时候密钥的分配问题。但是当网络规模很大时，每个用户所要保存的主密钥的数量也会很多

### 中心化密钥控制

Needham 协议，Kerberos 协议

公钥密码学仅限于用在密钥管理和签名这类应用中

<img src="https://cdn.jsdelivr.net/gh/JingqingLin/ImageHosting@master/img/20200604111602.png" width="70%"/>

RSA 填充，抵抗选择密文攻击

中间人攻击（没有做身份识别）